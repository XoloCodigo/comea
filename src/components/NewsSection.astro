---
/**
 * Componente: NewsSection
 * 
 * Muestra el listado de noticias recientes.
 * 
 * INTEGRACIÓN CON WORDPRESS:
 * - Este contenido corresponde a las "Entradas" (Posts) nativas de WordPress.
 * - Campos nativos a usar:
 *   - Título (Post Title)
 *   - Contenido (Post Content) -> Se inyectará en el sidebar.
 *   - Extracto (Excerpt) -> Para la tarjeta de resumen.
 *   - Imagen Destacada (Featured Image).
 *   - Categorías (Taxonomía nativa).
 *   - Fecha de publicación.
 * 
 * NOTA: El array `newsArticles` simula la respuesta que recibiríamos de la API de WordPress.
 */
import { Icon } from 'astro-icon/components';

// Importaciones de imágenes (Vite/Astro procesará esto)
import famex1 from "../assets/noticias/comea en famex 1.png";
import famex2 from "../assets/noticias/comea en famex 2.png";

import toma1 from "../assets/noticias/toma de protesta 1.png";
import toma2 from "../assets/noticias/toma de protesta 2.png";
import toma3 from "../assets/noticias/toma de protesta 3.png";
import toma4 from "../assets/noticias/toma de protesta 4.png";

// DATOS DE LAS NOTICIAS
const newsArticles = [
    {
        id: 'famex-2025',
        date: 'Abril 2025',
        category: 'Evento',
        title: 'Participación COMEA en FAMEX 2025',
        summary: 'COMEA tuvo una destacada participación en la Feria Aeroespacial México, fortaleciendo nuestra presencia y generando vínculos estratégicos.',
        images: [
            famex1,
            famex2
        ],
        content: `
            <p class="mb-4 text-lg leading-relaxed">El Consejo Mexicano de Educación Aeroespacial (COMEA) se hizo presente con éxito en la Feria Aeroespacial México (FAMEX), consolidando su papel como puente entre la academia y la industria.</p>
            <p class="mb-4 leading-relaxed">Durante el evento, nuestro Director, Ing. Federico Fuentes Pérez, encabezó la delegación con el objetivo de establecer nuevas alianzas estratégicas.</p>
            <h3 class="font-bold text-xl text-comea-main dark:text-white mt-6 mb-3">Logros Destacados</h3>
            <ul class="list-disc pl-5 mb-4 space-y-2">
                <li>Fortalecimiento de lazos con la industria de fabricación y mantenimiento.</li>
                <li>Presentación del avance de la Agenda Estratégica 2030.</li>
                <li>Reuniones clave con delegaciones internacionales.</li>
            </ul>
            <p class="mt-6 text-sm text-slate-500">Agradecemos a los organizadores por la invitación y la cálida recepción.</p>
        `
    },
    {
        id: 'toma-protesta-2024',
        date: 'Febrero 2024',
        category: 'Institucional',
        title: 'Toma de protesta del Consejo Administrativo del COMEA - 2024-2027',
        summary: 'El COMEA celebró la toma de protesta del nuevo consejo de administración para el periodo 2024-2027, presidido por el Ing. Federico Pérez Fuentes.',
        images: [
            toma1,
            toma2,
            toma3,
            toma4
        ],
        content: `
            <p class="mb-4 text-lg leading-relaxed">Este martes 25 de febrero, el <strong>Consejo Mexicano de Educación Aeroespacial (COMEA)</strong> celebró la toma de protesta del nuevo consejo de administración para el periodo <strong>2024-2027</strong>, marcando un logro en la consolidación de la academia para un impacto al sector aeroespacial en México.</p>
            
            <h3 class="font-bold text-xl text-comea-main dark:text-white mt-6 mb-3">Nuevo Consejo Directivo</h3>
            <p class="mb-4 leading-relaxed">El consejo quedó encabezado por:</p>
            <ul class="list-disc pl-5 mb-4 space-y-1">
                <li><strong>Presidente:</strong> Ing. Federico Pérez Fuentes</li>
                <li><strong>Secretario:</strong> Ing. Sergio Mancinas</li>
                <li><strong>Tesorero:</strong> Dr. Diego Alfredo Padilla Pérez</li>
            </ul>
            <p class="mb-4 leading-relaxed">Consejeros: Lic. Guillermo Mejía Ángeles, Dr. José de Jesús Alarcón Córdoba, Mtro. Luis Alfonso Rivera Campos y Dr. Arnulfo Treviño Cubero.</p>

            <h3 class="font-bold text-xl text-comea-main dark:text-white mt-6 mb-3">Visión y Compromiso</h3>
            <p class="mb-4 leading-relaxed">El <strong>Ing. Federico Pérez Fuentes</strong> expresó el compromiso de la organización por fomentar una vinculación efectiva: <em>"Nuestra meta es ser una plataforma que facilite esta colaboración"</em>.</p>
            
            <p class="mb-4 leading-relaxed">Por su parte, el <strong>Ing. Sergio Mancinas</strong> destacó que el COMEA ha sido un referente en la educación aeroespacial en México, fundamental en el crecimiento de las instituciones formadoras de talento.</p>

            <p class="mt-6 text-sm text-slate-500 italic">En el evento se agradeció al Mtro. Jorge Gutiérrez de Velazco, presidente saliente, por su liderazgo y valioso trabajo.</p>
        `
    }
];
---

<section id="noticias" class="py-20">
    <div class="max-w-4xl mx-auto px-6">
        <h1 class="text-4xl font-bold text-comea-main dark:text-white mb-10 border-b border-slate-200 dark:border-slate-700 pb-4">Sala de Prensa</h1>
        
        <div class="space-y-10">
            {newsArticles.map((article) => (
                <div class="flex flex-col md:flex-row gap-6 group bg-white dark:bg-dark-card rounded-xl p-4 shadow-sm hover:shadow-lg transition-shadow border border-slate-100 dark:border-slate-800">
                    <!-- Imagen / Icono (Usamos la primera imagen como miniatura) -->
                    <div class="w-full md:w-1/3 h-48 rounded-lg overflow-hidden shrink-0 bg-slate-100 dark:bg-slate-800 flex items-center justify-center border border-slate-200 dark:border-slate-700">
                        <img 
                            src={typeof article.images[0] === 'string' ? article.images[0] : article.images[0].src} 
                            alt={`Imagen de ${article.title}`} 
                            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                        />
                    </div>
                    
                    <!-- Texto y Botón -->
                    <div class="w-full md:w-2/3 flex flex-col justify-center py-2">
                        <div class="flex items-center gap-3 mb-2">
                            <span class={`px-3 py-1 text-xs rounded-full font-bold ${article.category === 'Evento' ? 'bg-comea-main text-white' : 'bg-slate-200 text-slate-700'}`}>
                                {article.category}
                            </span>
                            <span class="text-xs text-slate-500 dark:text-slate-400">{article.date}</span>
                        </div>
                        
                        <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 mb-2 group-hover:text-comea-tech transition-colors">
                            {article.title}
                        </h2>
                        
                        <p class="text-slate-600 dark:text-slate-400 text-sm mb-4 line-clamp-2">
                            {article.summary}
                        </p>
                        
                        <!-- BOTÓN LEER MÁS -->
                        <button 
                            type="button"
                            class="text-comea-main dark:text-comea-tech font-bold text-sm hover:underline flex items-center cursor-pointer bg-transparent border-none p-0 outline-none focus:ring-2 focus:ring-offset-2 focus:ring-comea-tech rounded"
                            onclick={`openNewsById('${article.id}')`}
                        >
                            Leer más <Icon name="fa6-solid:angle-right" class="ml-2" />
                        </button>
                    </div>
                </div>
            ))}
        </div>
        
        <!-- Paginación (Visual) -->
        <div class="flex justify-center mt-12 space-x-2">
            <button class="px-4 py-2 text-white bg-comea-main rounded-lg text-sm font-semibold hover:bg-comea-light transition-colors">1</button>
            <button class="px-4 py-2 text-slate-600 dark:text-slate-300 bg-slate-100 dark:bg-slate-800 rounded-lg text-sm hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">2</button>
        </div>
    </div>
</section>

<!-- SCRIPT DE LA SECCIÓN: Lógica de conexión CON TOGGLE -->
<script define:vars={{ newsArticles }} is:inline>
    window.comeaNewsData = newsArticles;
    window.currentOpenNewsId = null;

    window.openNewsById = (id) => {
        const sidebar = document.getElementById('news-sidebar');
        const isSidebarOpen = sidebar && !sidebar.style.transform.includes('100%');

        if (isSidebarOpen && window.currentOpenNewsId === id) {
            if (typeof window.closeNewsDetail === 'function') {
                window.closeNewsDetail();
            }
            window.currentOpenNewsId = null;
        } 
        else {
            const article = window.comeaNewsData.find(a => a.id === id);
            if (article && typeof window.openNewsDetail === 'function') {
                window.openNewsDetail(article);
                window.currentOpenNewsId = id;
            } else {
                console.error("Error: No se encontró la noticia o el Sidebar no está listo.");
            }
        }
    };
</script>